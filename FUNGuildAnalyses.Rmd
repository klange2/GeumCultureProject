#FUNGuild analyses

# Libraries

```{r}

library(plotrix)
library(patchwork)
library(agricolae)
library(egg)
library(ggpubr)

```
# ANOVA Helmert

```{r}

options(contrasts=c("contr.helmert","contr.poly"))

```

# Plant Pathogen

only FF-Q had 1 plant pathogen
This was the only one that was confident it was a plant pathogen
There were other samples that could possibly be other things as well

``` {r}
head(dat7)
dat7$plantpathogenpercent<-dat7$plantpathogen/dat7$totalabundance*100
dat7$plantpathogentaxapercent<-dat7$plantpathogentaxa/dat7$SR*100
dat7$plantpathogenbroadpercent<-dat7$plantpathogenbroad/dat7$totalabundance*100
dat7$plantpathogenbroadprobablehppercent<-dat7$plantpathogenbroadprobablehp/dat7$totalabundance*100
dat7$plantpathogenbroadprobablehptaxapercent<-dat7$plantpathogenbroadprobablehptaxa/dat7$SR*100


options(contrasts=c("contr.helmert","contr.poly"))

# confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
    mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantpathogentaxapercent),se=std.error(plantpathogentaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funp <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Plant Pathogen") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantpathogentaxapercent),se=std.error(plantpathogentaxapercent),count=n())

funp2 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 


# not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
    mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantpathogenbroadprobablehptaxapercent),se=std.error(plantpathogenbroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funp3 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Plant Pathogen") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantpathogenbroadprobablehptaxapercent),se=std.error(plantpathogenbroadprobablehptaxapercent),count=n())

funp4 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 

```
# Pathotroph

```{r}
head(dat7)
dat7$pathotrophpercent<-dat7$pathotroph/dat7$totalabundance*100
dat7$pathotrophtaxapercent<-dat7$pathotrophtaxa/dat7$SR*100
dat7$pathotrophbroadpercent<-dat7$pathotrophbroad/dat7$totalabundance*100
dat7$pathotrophbroadprobablehppercent<-dat7$pathotrophbroadprobablehp/dat7$totalabundance*100
dat7$pathotrophbroadprobablehptaxapercent<-dat7$pathotrophbroadprobablehptaxa/dat7$SR*100

#confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
    mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(pathotrophtaxapercent),se=std.error(pathotrophtaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funp5 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Pathotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(pathotrophtaxapercent),se=std.error(pathotrophtaxapercent),count=n())

funp6 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 

#not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
    mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(pathotrophbroadprobablehptaxapercent),se=std.error(pathotrophbroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funp7 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Pathotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(pathotrophbroadprobablehptaxapercent),se=std.error(pathotrophbroadprobablehptaxapercent),count=n())

funp8 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  ylim(0,85)+
  labs(x = "",y="Pathotroph",tag="B") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

#box plot with raw data
funp9 <- ggplot(dat7,aes(x=Community.x,y=pathotrophbroadprobablehptaxapercent,color=Community.x,group=Community.x))+
  geom_boxplot()+
  geom_point()+
  ylim(0,100)+
  labs(x = "",y="Pathotroph",tag="B") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))

```


# Ericoid Mycorrhizal

``` {r}
head(dat7)
dat7$ericoidpercent<-dat7$ericoid/dat7$totalabundance*100
dat7$ericoidtaxapercent<-dat7$ericoidtaxa/dat7$SR*100
dat7$ericoidbroadpercent<-dat7$ericoidbroad/dat7$totalabundance*100
dat7$ericoidbroadprobablehppercent<-dat7$ericoidbroadprobablehp/dat7$totalabundance*100
dat7$ericoidbroadprobablehptaxapercent<-dat7$ericoidbroadprobablehptaxa/dat7$SR*100

options(contrasts=c("contr.helmert","contr.poly"))

#confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(ericoidtaxapercent),se=std.error(ericoidtaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funer <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Ericoid Mycorrhizal") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(ericoidtaxapercent),se=std.error(ericoidtaxapercent),count=n())

funer2 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 

# not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(ericoidbroadprobablehptaxapercent),se=std.error(ericoidbroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funer3 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Ericoid Mycorrhizal") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(ericoidbroadprobablehptaxapercent),se=std.error(ericoidbroadprobablehptaxapercent),count=n())

funer4 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Ericoid \n Mycorrhiza",tag="D") +
  ylim(0,85)+
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

#box plot with raw data
funer5 <- ggplot(dat7,aes(x=Community.x,y=ericoidbroadprobablehptaxapercent,color=Community.x,group=Community.x))+
  geom_boxplot()+
  geom_point()+
  labs(x = "",y="Ericoid \n Mycorrhiza",tag="D") +
  ylim(0,100)+
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))

```
# Symbiotroph

```{r}

dat7$symbiotrophpercent<-dat7$symbiotroph/dat7$totalabundance*100
dat7$symbiotrophtaxapercent<-dat7$symbiotrophtaxa/dat7$SR*100
dat7$symbiotrophbroadpercent<-dat7$symbiotrophbroad/dat7$totalabundance*100
dat7$symbiotrophbroadprobablehppercent<-dat7$symbiotrophbroadprobablehp/dat7$totalabundance*100
dat7$symbiotrophbroadprobablehptaxapercent<-dat7$symbiotrophbroadprobablehptaxa/dat7$SR*100

#confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(symbiotrophtaxapercent),se=std.error(symbiotrophtaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funsym <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Symbiotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
    mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(symbiotrophtaxapercent),se=std.error(symbiotrophtaxapercent),count=n())

funsym2 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

#not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(symbiotrophbroadprobablehptaxapercent),se=std.error(symbiotrophbroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funsym3 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Symbiotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
    mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(symbiotrophbroadprobablehptaxapercent),se=std.error(symbiotrophbroadprobablehptaxapercent),count=n())

funsym4 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Symbiotroph",tag="A") +
  ylim(0,85)+
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

#box plot with raw data
funsym5 <- ggplot(dat7,aes(x=Community.x,y=symbiotrophbroadprobablehptaxapercent,color=Community.x,group=Community.x))+
  geom_boxplot()+
  geom_point()+
  labs(x = "",y="Symbiotroph",tag="A") +
  ylim(0,100)+
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))

```
# Saprotroph

```{r}

head(dat7)
dat7$saprotrophpercent<-dat7$saprotroph/dat7$totalabundance*100
dat7$saprotrophtaxapercent<-dat7$saprotrophtaxa/dat7$SR*100
dat7$saprotrophbroadpercent<-dat7$saprotrophbroad/dat7$totalabundance*100
dat7$saprotrophbroadprobablehppercent<-dat7$saprotrophbroadprobablehp/dat7$totalabundance*100
dat7$saprotrophbroadprobablehptaxapercent<-dat7$saprotrophbroadprobablehptaxa/dat7$SR*100

options(contrasts=c("contr.helmert","contr.poly"))

#confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(saprotrophtaxapercent),se=std.error(saprotrophtaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funsap <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Saprotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(saprotrophtaxapercent),se=std.error(saprotrophtaxapercent),count=n())

funsap2 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 

#not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(saprotrophbroadprobablehptaxapercent),se=std.error(saprotrophbroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funsap3 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Saprotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(saprotrophbroadprobablehptaxapercent),se=std.error(saprotrophbroadprobablehptaxapercent),count=n())

funsap4 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Saprotroph",tag="C") +
  ylim(0,85)+
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

#box plot with raw data
funsap5 <- ggplot(dat7,aes(x=Community.x,y=saprotrophbroadprobablehptaxapercent,color=Community.x,group=Community.x))+
    geom_boxplot()+
  geom_point()+
  labs(x = "",y="Saprotroph",tag="C") +
  ylim(0,100)+
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))

```
# Plant Saprotroph

```{r}

head(dat7)
dat7$plantsaprotrophpercent<-dat7$plantsaprotroph/dat7$totalabundance*100
dat7$plantsaprotrophtaxapercent<-dat7$plantsaprotrophtaxa/dat7$SR*100
dat7$plantsaprotrophbroadpercent<-dat7$plantsaprotrophbroad/dat7$totalabundance*100
dat7$plantsaprotrophbroadprobablehppercent<-dat7$plantsaprotrophbroadprobablehp/dat7$totalabundance*100
dat7$plantsaprotrophbroadprobablehptaxapercent<-dat7$plantsaprotrophbroadprobablehptaxa/dat7$SR*100

options(contrasts=c("contr.helmert","contr.poly"))

#confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantsaprotrophtaxapercent),se=std.error(plantsaprotrophtaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funpsap <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Plant Saprotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantsaprotrophtaxapercent),se=std.error(plantsaprotrophtaxapercent),count=n())

funpsap2 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 

#not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantsaprotrophbroadprobablehptaxapercent),se=std.error(plantsaprotrophbroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funpsap3 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Plant Saprotroph") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(plantsaprotrophbroadprobablehptaxapercent),se=std.error(plantsaprotrophbroadprobablehptaxapercent),count=n())

funpsap4 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

```
# Endophyte

```{r}

head(dat7)
dat7$endophytepercent<-dat7$endophyte/dat7$totalabundance*100
dat7$endophytetaxapercent<-dat7$endophytetaxa/dat7$SR*100
dat7$endophytebroadpercent<-dat7$endophytebroad/dat7$totalabundance*100
dat7$endophytebroadprobablehppercent<-dat7$endophytebroadprobablehp/dat7$totalabundance*100
dat7$endophytebroadprobablehptaxapercent<-dat7$endophytebroadprobablehptaxa/dat7$SR*100

options(contrasts=c("contr.helmert","contr.poly"))

#confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(endophytetaxapercent),se=std.error(endophytetaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funend <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Endophyte") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(endophytetaxapercent),se=std.error(endophytetaxapercent),count=n())

funend2 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) 

#not as confident
pathmean<-dat7%>%
  group_by(Community.x,Site)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(endophytebroadprobablehptaxapercent),se=std.error(endophytebroadprobablehptaxapercent),count=n())

#pdf("/Users/farrer/Dropbox/EmilyComputerBackup/Documents/LAmarsh/Culturing/Manuscripts/richness.pdf",width=6.6,height=3.5)
funend3 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="Endophyte") +
  theme_classic()+
  theme(line=element_line(size=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1) +
  facet_wrap(vars(Site),strip.position = "bottom")
#dev.off()

pathmean<-dat7%>%
  group_by(Community.x)%>%
  mutate(Community.x = fct_relevel(Community.x,"SB", "MM", "DM", "FF"))%>%
  summarise(mean=mean(endophytebroadprobablehptaxapercent),se=std.error(endophytebroadprobablehptaxapercent),count=n())

funend4 <- ggplot(pathmean,aes(x=Community.x,y=mean,color=Community.x,group=Community.x))+
  labs(x = "",y="") +
  theme_classic()+
  theme(line=element_line(linewidth=.3),text=element_text(size=12),strip.background = element_rect(colour="white", fill="white"),axis.line=element_line(color="gray30",linewidth=.5),legend.position = "none",strip.placement = "outside",panel.spacing=unit(0,"cm"),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),panel.background = element_rect(fill = NA, color = "gray50"))+
  geom_point(size=2.75)+
  geom_errorbar(aes(ymax = mean+se, ymin=mean-se),width=.35,size=1)

```


# Large funguild figure

```{r}

# all plots together using the patchwork package
funall <- (funp | funp2) / (funer | funer2)
funall <- funall + plot_annotation(
  title = 'Average Percentage',
  theme = theme(plot.title = element_text(hjust = 0.5)))

funall2 <- (funsym | funsym2) / (funsap | funsap2)

# confident figures
con1 <- (funer|funer2)
con2 <- (funp5|funp6)/(funp|funp2)
con3 <- (funsap|funsap2)/(funpsap|funpsap2)
con4 <- (funsym|funsym2)/(funend|funend2)

# not as confident figures
non1 <- (funsym3|funsym4)/(funend3|funend4)
non2 <- (funp7|funp8)/(funp3|funp4)
non3 <- (funsap3|funsap4)/(funpsap3|funpsap4)
non4 <- (funer3|funer4)

#trophic modes only
trop <- (funsym4|funp8)/(funsap4|funer4)

trop <- ggarrange(funsym4, funp8, funsap4,funer4, ncol = 2, nrow = 2)
annotate_figure(trop, top = text_grob("Average Percentage in Probable/Highly Probable Taxa", 
               color = "black",face = "bold", size = 14))
ggsave("trop.png")


#trophic mode box plot with raw data
trop2 <- ggarrange(funsym5, funp9, funsap5,funer5, ncol = 2, nrow = 2)
annotate_figure(trop2, top = text_grob("Average Percentage in Probable/Highly Probable Taxa", 
               color = "black", face = "bold", size = 14))
ggsave("trop2.png")

```


# Stats

## Anovas

```{r}

#plant pathogen
#m1p<-gls(plantpathogentaxapercent~Community.x,data=dat7,na.action=na.omit)
#m1p<-lme(plantpathogentaxapercent~Community.x*Site,random=~1|PlantIndividual,data=dat7,na.action=na.omit)
#anova(m1p)
m1p<-lm(plantpathogentaxapercent~Community.x,data=dat7,na.action=na.omit)
anova(m1p)
hist(resid(m1p))
boxplot(resid(m1p)~dat7$CommunitySitePL)
m2p<-lm(plantpathogentaxapercent~Site,data=dat7,na.action=na.omit)
anova(m2p)
m3p<-lm(plantpathogenbroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
anova(m3p)
hist(resid(m3p))
boxplot(resid(m3p)~dat7$CommunitySitePL)
m4p<-lm(plantpathogenbroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
anova(m4p)
#m2p<-lme(plantpathogentaxapercent~Community.x*Site,random=~1|PlantIndividual,data=dat7,na.action=na.omit)
#anova(m2p,type="marginal")


#pathotroph
m1p<-gls(pathotrophbroadprobablehptaxapercent~Community.x*Site,data=dat7,na.action=na.omit)
anova(m1p,type="marginal")
#m5p<-lm(pathotrophtaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m5p)
#hist(resid(m5p))
#boxplot(resid(m5p)~dat7$CommunitySitePL)
#m6p<-lm(pathotrophtaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m6p)
#m7p<-lm(pathotrophbroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m7p)
#hist(resid(m7p))
#boxplot(resid(m7p)~dat7$CommunitySitePL)
#m8p<-lm(pathotrophbroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m8p)


#ericoid
m1e<-gls(ericoidbroadprobablehptaxapercent~Community.x*Site,data=dat7,na.action=na.omit)
anova(m1e,type="marginal")
#m1e<-lm(ericoidtaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m1e)
#hist(resid(m1e))
#boxplot(resid(m1e)~dat7$CommunitySitePL)
#m2e<-lm(ericoidtaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m2e)
#m3e<-lm(ericoidbroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m3e)
#hist(resid(m3e))
#boxplot(resid(m3e)~dat7$CommunitySitePL)
#m4e<-lm(ericoidbroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m4e)
#m2e<-lme(ericoidtaxapercent~Community.x*Site,random=~1|PlantIndividual,data=dat7,na.action=na.omit)
#anova(m2e,type="marginal")


#symbiotroph
#m1sym<-lme(symbiotrophtaxapercent~Community.x+Site,random=~1|PlantIndividual,data=dat7,na.action=na.omit)
#anova(m1sym,type="marginal")
#hist(resid(m1sym))
#boxplot(resid(m1sym)~dat7$CommunitySitePL)
m2sym<-gls(symbiotrophbroadprobablehptaxapercent~Community.x*Site,data=dat7,na.action=na.omit)
anova(m2sym,type="marginal")
#m1sym<-lm(symbiotrophtaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m1sym)
#hist(resid(m1sym))
#m2sym<-lm(symbiotrophtaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m2sym)
#m3sym<-lm(symbiotrophbroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m3sym)
#hist(resid(m3sym))
#boxplot(resid(m3sym)~dat7$CommunitySitePL)
#m4sym<-lm(symbiotrophbroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m4sym)


#saprotroph
#m1sap<-lme(saprotrophtaxapercent~Community.x+Site,random=~1|PlantIndividual,data=dat7,na.action=na.omit)
#(m1sap,type="marginal")
#hist(resid(m1sap))
#boxplot(resid(m1sap)~dat7$CommunitySitePL)
m2sap<-gls(saprotrophbroadprobablehptaxapercent~Community.x*Site,data=dat7,na.action=na.omit)
anova(m2sap,type="marginal")
#m1sap<-lm(saprotrophtaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m1sap)
#hist(resid(m1sap))
#boxplot(resid(m1sap)~dat7$CommunitySitePL)
#m2sap<-lm(saprotrophtaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m2sap)
#m3sap<-lm(saprotrophbroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
#anova(m3sap)
#hist(resid(m3sap))
#boxplot(resid(m3sap)~dat7$CommunitySitePL)
#m4sap<-lm(saprotrophbroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
#anova(m4sap)

#plant saprotroph
m1psap<-lm(plantsaprotrophtaxapercent~Community.x,data=dat7,na.action=na.omit)
anova(m1psap)
hist(resid(m1psap))
boxplot(resid(m1psap)~dat7$CommunitySitePL)
m2psap<-lm(plantsaprotrophtaxapercent~Site,data=dat7,na.action=na.omit)
anova(m2psap)
m3psap<-lm(plantsaprotrophbroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
anova(m3psap)
hist(resid(m3psap))
boxplot(resid(m3psap)~dat7$CommunitySitePL)
m4psap<-lm(plantsaprotrophbroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
anova(m4psap)

#endophyte
m1end<-lm(endophytetaxapercent~Community.x,data=dat7,na.action=na.omit)
anova(m1end)
hist(resid(m1end))
boxplot(resid(m1end)~dat7$CommunitySitePL)
m2end<-lm(endophytetaxapercent~Site,data=dat7,na.action=na.omit)
anova(m2end)
m3end<-lm(endophytebroadprobablehptaxapercent~Community.x,data=dat7,na.action=na.omit)
anova(m3end)
hist(resid(m3end))
boxplot(resid(m3end)~dat7$CommunitySitePL)
m4end<-lm(endophytebroadprobablehptaxapercent~Site,data=dat7,na.action=na.omit)
anova(m4end)

```
##Tukey

```{r}
#plant pathogen
tuk_p = aov(plantpathogentaxapercent ~ Community.x, data = dat7)
summary(tuk_p)

hsd_path <- TukeyHSD(tuk_p) # require the agricolae package  
hsd_path2 <- HSD.test(tuk_p, "Community.x", group=T)$groups  
show(hsd_path2)

tuk_ps = aov(plantpathogentaxapercent ~ Site, data = dat7)
summary(tuk_ps)

hsd_ps <- TukeyHSD(tuk_ps) # require the agricolae package  
hsd_ps2 <- HSD.test(tuk_ps, "Site", group=T)$groups  
show(hsd_ps2)

tuk_p2 = aov(plantpathogenbroadprobablehptaxapercent ~ Community.x, data = dat7)
summary(tuk_p2)

hsd_path3 <- TukeyHSD(tuk_p2) # require the agricolae package  
hsd_path4 <- HSD.test(tuk_p2, "Community.x", group=T)$groups  
show(hsd_path4)

#pathotroph
tuk_p3 = aov(pathotrophtaxapercent ~ Community.x, data = dat7)
summary(tuk_p3)

hsd_path3 <- TukeyHSD(tuk_p3) # require the agricolae package  
hsd_path4 <- HSD.test(tuk_p3, "Community.x", group=T)$groups  
show(hsd_path4)

tuk_p3s = aov(pathotrophtaxapercent ~ Site, data = dat7)
summary(tuk_p3s)

hsd_p3s <- TukeyHSD(tuk_p3s) # require the agricolae package  
hsd_p3s2 <- HSD.test(tuk_p3s, "Site", group=T)$groups  
show(hsd_p3s2)

#ericoid mycorrhizal
tuk_e = aov(ericoidtaxapercent ~ Community.x, data = dat7)
summary(tuk_e)

hsd_e <- TukeyHSD(tuk_e) # require the agricolae package  
hsd_e2 <- HSD.test(tuk_e, "Community.x", group=T)$groups  
show(hsd_e2)

tuk_es = aov(ericoidtaxapercent ~ Site, data = dat7)
summary(tuk_es)

hsd_es <- TukeyHSD(tuk_es) # require the agricolae package  
hsd_es2 <- HSD.test(tuk_es, "Site", group=T)$groups  
show(hsd_es2)

tuk_e2 = aov(ericoidbroadprobablehptaxapercent ~ Community.x, data = dat7)
summary(tuk_e2)

hsd_e3 <- TukeyHSD(tuk_e2) # require the agricolae package  
hsd_e4 <- HSD.test(tuk_e2, "Community.x", group=T)$groups  
show(hsd_e4)

#symbiotrophs
tuk_sym = aov(symbiotrophtaxapercent ~ Community.x, data = dat7)
summary(tuk_sym)

hsd_sym <- TukeyHSD(tuk_sym) # require the agricolae package  
hsd_sym2 <- HSD.test(tuk_sym, "Community.x", group=T)$groups  
show(hsd_sym2)

tuk_sys = aov(symbiotrophtaxapercent ~ Site, data = dat7)
summary(tuk_sys)

hsd_sys <- TukeyHSD(tuk_sys) # require the agricolae package  
hsd_sys2 <- HSD.test(tuk_sys, "Site", group=T)$groups  
show(hsd_sys2)

#saprotrophs
tuk_sap = aov(saprotrophtaxapercent ~ Community.x, data = dat7)
summary(tuk_sap)

hsd_sap <- TukeyHSD(tuk_sap) # require the agricolae package  
hsd_sap2 <- HSD.test(tuk_sap, "Community.x", group=T)$groups  
show(hsd_sap2)

tuk_sas = aov(saprotrophtaxapercent ~ Site, data = dat7)
summary(tuk_sas)

hsd_sas <- TukeyHSD(tuk_sas) # require the agricolae package  
hsd_sas2 <- HSD.test(tuk_sas, "Site", group=T)$groups  
show(hsd_sas2)

tuk_sap2 = aov(saprotrophbroadprobablehptaxapercent ~ Community.x, data = dat7)
summary(tuk_sap2)

hsd_sap3 <- TukeyHSD(tuk_sap2) # require the agricolae package  
hsd_sap4 <- HSD.test(tuk_sap2, "Community.x", group=T)$groups  
show(hsd_sap4)

#plant saprotroph
tuk_psap = aov(plantsaprotrophbroadprobablehptaxapercent ~ Community.x, data = dat7)
summary(tuk_psap)

hsd_psap <- TukeyHSD(tuk_psap) # require the agricolae package  
hsd_psap2 <- HSD.test(tuk_psap, "Community.x", group=T)$groups  
show(hsd_psap2)

#endophytes
tuk_end = aov(endophytebroadprobablehptaxapercent ~ Community.x, data = dat7)
summary(tuk_end)

hsd_end <- TukeyHSD(tuk_end) # require the agricolae package  
hsd_end2 <- HSD.test(tuk_end, "Community.x", group=T)$groups  
show(hsd_end2)

```

# Pie charts by species
this didn't seem very useful so I discontinued
get the full list of taxa from each species, and make a pie chart

```{r}
otulist<-dat7%>%
  group_by(Community.x)%>%
  summarise(across(OTU0:OTU9,sum))

ind<-which(guilds2$guild=="Plant Pathogen")
pathos<-guilds2[ind,]$OTU

DM<-colnames(otulist)[which(otulist[1,]>0)]
DM2<-length(which(pathos%in%DM))
DM3<-length(DM)
pie(c(DM2/DM3,1-DM2/DM3),col=c("black","green"))

SB<-colnames(otulist)[which(otulist[2,]>0)]
SB2<-length(which(pathos%in%SB))
SB3<-length(SB)
pie(c(SB2/SB3,1-SB2/SB3),col=c("black","green"))

```